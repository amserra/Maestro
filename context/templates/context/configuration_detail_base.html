{% extends 'base.html' %}
{% load my_filters %}

{% block content %}
    <div class="page-container lg:w-3/5 min-h-45rem flex flex-col">
        <div class="xl:w-full">
            <div class="mb-10">
                {% block breadcrumb %}
                {% endblock breadcrumb %}
            </div>
            <div class="flex flex-row justify-between items-center">
                <div class="mr-6">
                    <p class="title">{{ context.name }}</p>
                </div>
                <div>
                    <a href="{% url 'contexts-list' %}" class="btn-cancel">Back</a>
                </div>
            </div>
            {% block tabs %}
            {% endblock tabs %}

            {% block detail %}
            {% endblock detail %}
        </div>
        <div class="mt-auto">
            {% if context.owner_type.name == 'user' or context.owner_type.name == 'organization' and context.owner.members_can_edit %}
                {% if context.configuration %}
                    <a href="{% url 'contexts-start' context.code %}" class="btn-success">Start</a>
                {% endif %}
                <a href="{% url 'contexts-configuration-update' context.code %}?from={{ request.path }}" class="btn-primary">Configure</a>
                <a  href="#"
                    onclick="
                            openModal(
                            'modal-delete',
                            acceptModalDelete,
                            {title: 'Are you sure you want to delete the context {{ context.code }}?', subtitle: 'This action will be effective.'},
                            {code: '{{ context.code }}'}
                            )"
                    class="btn-danger">
                    Delete
                </a>
            {% endif %}
        </div>
    </div>

    {% include 'common/confirmation-modal.html' with id='modal-delete' %}

    <script>
        function acceptModalDelete(modal) {
            // 'contexts-delete'
            const url = "{% url 'contexts-delete' context.code %}";
            fetch(url).then(response => window.location.replace(response.url));
        }
    </script>
{% endblock content %}